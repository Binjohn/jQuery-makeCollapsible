(function(){function toggleElement($collapsible,action,$defaultToggle,options){var $collapsibleContent,$containers,hookCallback;options=options||{};if(!$collapsible.jquery){return}if(action!=='expand'&&action!=='collapse'){return}if($defaultToggle===undefined){$defaultToggle=null}$collapsible.trigger(action==='expand'?'beforeExpand.mw-collapsible':'beforeCollapse.mw-collapsible');hookCallback=function(){$collapsible.trigger(action==='expand'?'afterExpand.mw-collapsible':'afterCollapse.mw-collapsible')};if(!options.plainMode&&$collapsible.is('table')){if($collapsible.find('> caption').length){$containers=$collapsible.find('> * > tr')}else{$containers=$collapsible.find('> tbody > tr')}if($defaultToggle){$containers=$containers.not($defaultToggle.closest('tr'))}}else if(!options.plainMode&&($collapsible.is('ul')||$collapsible.is('ol'))){$containers=$collapsible.find('> li');if($defaultToggle){$containers=$containers.not($defaultToggle.parent())}}else{$collapsibleContent=$collapsible.find('> .mw-collapsible-content');if(!options.plainMode&&$collapsibleContent.length){$containers=$collapsibleContent}else{$containers=$collapsible}}$containers.toggle(action==='expand');hookCallback()}function togglingHandler($toggle,$collapsible,e,options){var wasCollapsed,$textContainer,collapseText,expandText;options=options||{};if(e){if(e.type==='click'&&e.target.nodeName.toLowerCase()==='a'&&$(e.target).attr('href')){return}else if(e.type==='keypress'&&e.which!==13&&e.which!==32){return}else{e.preventDefault();e.stopPropagation()}}if(options.wasCollapsed!==undefined){wasCollapsed=options.wasCollapsed}else{wasCollapsed=$collapsible.hasClass('mw-collapsed')}$collapsible.toggleClass('mw-collapsed',!wasCollapsed);if(options.toggleClasses){$toggle.toggleClass('mw-collapsible-toggle-collapsed',!wasCollapsed).toggleClass('mw-collapsible-toggle-expanded',wasCollapsed)}if(options.toggleARIA){$toggle.attr('aria-expanded',wasCollapsed?'true':'false')}if(options.toggleText){collapseText=options.toggleText.collapseText;expandText=options.toggleText.expandText;$textContainer=$toggle.find('.mw-collapsible-text');if($textContainer.length){$textContainer.text(wasCollapsed?collapseText:expandText)}}toggleElement($collapsible,wasCollapsed?'expand':'collapse',$toggle,options)}$.fn.makeCollapsible=function(options){options=options||{};this.each(function(){var $collapsible,collapseText,expandText,$caption,$toggle,actionHandler,buildDefaultToggleLink,$firstItem,collapsibleId,$customTogglers,firstval;$collapsible=$(this).addClass('mw-collapsible');if($collapsible.data('mw-made-collapsible')){return}else{$collapsible.addClass('mw-made-collapsible').data('mw-made-collapsible',true)}collapseText=options.collapseText||$collapsible.attr('data-collapsetext')||'合併';expandText=options.expandText||$collapsible.attr('data-expandtext')||'展開';actionHandler=function(e,opts){var defaultOpts={toggleClasses:true,toggleARIA:true,toggleText:{collapseText:collapseText,expandText:expandText}};opts=$.extend(defaultOpts,options,opts);togglingHandler($(this),$collapsible,e,opts)};buildDefaultToggleLink=function(){return $('<a>').addClass('mw-collapsible-text').text(collapseText).wrap('<span class="mw-collapsible-toggle mw-collapsible-toggle-default"></span>').parent().attr({role:'button',tabindex:0})};if(options.$customTogglers){$customTogglers=$(options.$customTogglers)}else{collapsibleId=$collapsible.attr('id')||'';if(collapsibleId.indexOf('mw-customcollapsible-')===0){collapsibleId=$.escapeSelector(collapsibleId);$customTogglers=$('.'+collapsibleId.replace('mw-customcollapsible','mw-customtoggle')).addClass('mw-customtoggle')}}if($customTogglers&&$customTogglers.length){actionHandler=function(e,opts){var defaultOpts={};opts=$.extend(defaultOpts,options,opts);togglingHandler($(this),$collapsible,e,opts)};$toggle=$customTogglers}else{if($collapsible.is('table')){$caption=$collapsible.find('> caption');if($caption.length){$toggle=$caption.find('> .mw-collapsible-toggle');if(!$toggle.length){$toggle=buildDefaultToggleLink().appendTo($caption)}}else{$firstItem=$collapsible.find('tr').first().find('th, td');$toggle=$firstItem.find('> .mw-collapsible-toggle');if(!$toggle.length){$toggle=buildDefaultToggleLink().prependTo($firstItem.eq(-1))}}}else if($collapsible.parent().is('li')&&$collapsible.parent().children('.mw-collapsible').length===1&&$collapsible.find('> .mw-collapsible-toggle').length===0){$toggle=buildDefaultToggleLink();$collapsible.before($toggle)}else if($collapsible.is('ul')||$collapsible.is('ol')){$firstItem=$collapsible.find('li').first();$toggle=$firstItem.find('> .mw-collapsible-toggle');if(!$toggle.length){firstval=$firstItem.prop('value');if(firstval===undefined||!firstval||firstval==='-1'||firstval===-1){$firstItem.prop('value','1')}$toggle=buildDefaultToggleLink();$toggle.wrap('<li class="mw-collapsible-toggle-li"></li>').parent().prependTo($collapsible)}}else{$toggle=$collapsible.find('> .mw-collapsible-toggle');if(!$collapsible.find('> .mw-collapsible-content').length){$collapsible.wrapInner('<div class="mw-collapsible-content"></div>')}if(!$toggle.length){$toggle=buildDefaultToggleLink().prependTo($collapsible)}}}$toggle.on('click.mw-collapsible keypress.mw-collapsible',actionHandler).attr('aria-expanded','true').prop('tabIndex',0);$(this).data('mw-collapsible',{collapse:function(){actionHandler.call($toggle.get(0),null,{wasCollapsed:false})},expand:function(){actionHandler.call($toggle.get(0),null,{wasCollapsed:true})},toggle:function(){actionHandler.call($toggle.get(0),null,null)}});if(options.collapsed||$collapsible.hasClass('mw-collapsed')){actionHandler.call($toggle.get(0),null,{wasCollapsed:false})}});return this}}());
